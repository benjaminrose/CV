name: Build LaTeX document

on: [push]

jobs:
  build_latex:
    runs-on: ubuntu-latest
    steps:
      - name: Set up Git repository
        uses: actions/checkout@v1
      
      - name: Compile LaTeX document
        uses: xu-cheng/latex-action@master
        with:
          root_file: Rose_CV.tex
          args: "-xelatex -file-line-error -interaction=nonstopmode"
          
      - name: Publish PDF
        run: |
          git checkout --orphan master-pdf
          git rm -rf .
          git add -f Rose_CV.pdf
          git -c user.name='github_actions' -c user.email='github_actions' commit -m "current pdf"
          git push -q -f https://benjamin:${{ secrets.GITHUB_TOKEN }}@github.com/benjaminrose/CV master-pdf
